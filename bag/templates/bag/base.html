{% load static %}
<!DOCTYPE html>
<html>
<head>
    <title>Green Bag Ecommerce</title>
    <link rel="stylesheet" type="text/css" href="{% static 'bag/css/style.css' %}">
    <link rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

</head>
<body>

<!-- NAVBAR -->
<nav class="navbar">
    <div class="logo">
        <a href="{% url 'index' %}">
            <img src="{% static 'bag/images/logo.png' %}" alt="GreenBag Logo">
            <h2>GreenBag</h2>
        </a>
    </div>

    <!-- NAV LINKS -->
    <div class="nav-links">
        <a href="{% url 'fruits' %}">Fruits</a>
        <a href="{% url 'milk' %}">Milk</a>
        <a href="{% url 'vegetables' %}">Vegetables</a>
    </div>

    <!-- SEARCH BAR -->
    <form method="GET" action="{% url 'search' %}" class="search-form">
        <input type="text" name="q" placeholder="Search products..." value="{{ request.GET.q|default:'' }}">
        <button type="submit">Search</button>
    </form>zzzz

     <!-- CART ICON -->
    <a href="{% url 'view_cart' %}" class="cart-icon">
        üõí
        {% if request.session.cart %}
            <span class="cart-count">{{ request.session.cart|length }}</span>
        {% endif %}
    </a>


    <!-- PROFILE CIRCLE -->
    <div class="profile">
        <div class="profile-circle">
            {% if user.is_authenticated %}
                {{ user.username|slice:":1"|upper }}
            {% else %}
                ?
            {% endif %}
        </div>

        <!-- DROPDOWN MENU -->
        <div class="dropdown">
            {% if user.is_authenticated %}
                <a href="{% url 'profile' %}">Profile</a>
                <a href="{% url 'logout' %}">Logout</a>
            {% else %}
                <a href="{% url 'login' %}">Login</a>
                <a href="{% url 'register' %}">Register</a>
            {% endif %}
        </div>
    </div>
</nav>


<!-- PAGE TITLE -->
<div class="page-title">
    {% block title %}{% endblock %}
</div>


<!-- MAIN CONTENT -->
<div class="content">
    {% block content %}{% endblock %}
</div>
<script>
document.querySelectorAll('.fav-btn').forEach(btn => {
    btn.addEventListener('click', function () {
        let productId = this.dataset.id;
        let button = this;

        fetch(`/favorite/${productId}/`)
        .then(response => response.json())
        .then(data => {
            if (data.status === 'added') {
                button.innerHTML = '‚ù§Ô∏è';
            } else {
                button.innerHTML = 'ü§ç';
                // Remove from profile page
                if (window.location.pathname.includes('profile')) {
                    button.closest('.product-card').remove();
                }
            }
        });
    });
});
</script>



</body>
</html>
